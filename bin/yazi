#!/bin/zsh
# Launch yazi file manager

YAZI_CONFIG_DIR="$HOME/.config/yazi"

# Check if yazi is installed
if ! command -v yazi &> /dev/null; then
    echo "Yazi is not installed."
    
    # Offer to install yazi
    read -q "REPLY?Would you like to install Yazi now? (y/n) "
    echo ""
    
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        if command -v brew &> /dev/null; then
            echo "Installing Yazi with Homebrew..."
            brew install yazi
        elif command -v cargo &> /dev/null; then
            echo "Installing Yazi with Cargo..."
            cargo install --locked yazi
        else
            echo "Neither Homebrew nor Cargo found. Please install Yazi manually."
            echo "Visit: https://github.com/sxyazi/yazi"
            exit 1
        fi
    else
        echo "Exiting without installing Yazi."
        exit 1
    fi
fi

# Ensure config directory exists
if [ ! -d "$YAZI_CONFIG_DIR" ]; then
    mkdir -p "$YAZI_CONFIG_DIR"
    echo "Created Yazi config directory at $YAZI_CONFIG_DIR"
fi

# Launch yazi with arguments
yazi "$@"
